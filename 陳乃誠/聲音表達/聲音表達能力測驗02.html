<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>聲音表達能力測驗 | 發現你的聲音潛能</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #ff9a8b 0%, #fad0c4 50%, #fecfef 100%);
            color: #2c2c2c;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* 動畫效果 */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes progressBar {
            from { width: 0%; }
            to { width: var(--progress); }
        }

        /* 主容器 */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 測驗標題 */
        .quiz-header {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            text-align: center;
            padding: 40px 20px;
            border-radius: 20px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .quiz-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255,255,255,0.1) 10px,
                rgba(255,255,255,0.1) 20px
            );
            animation: slideInLeft 3s ease-in-out infinite;
        }

        .quiz-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
        }

        .quiz-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            position: relative;
            z-index: 2;
        }

        /* 進度條 */
        .progress-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(255, 107, 53, 0.15);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .progress-text {
            font-weight: bold;
            color: #ff6b35;
        }

        .progress-bar {
            height: 12px;
            background: #f0f0f0;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #f7931e);
            border-radius: 6px;
            transition: width 0.8s ease;
            animation: progressBar 1s ease-out;
        }

        /* 測驗卡片 */
        .quiz-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(255, 107, 53, 0.15);
            animation: fadeInUp 0.8s ease-out;
            display: none;
        }

        .quiz-card.active {
            display: block;
        }

        .question-number {
            font-size: 1rem;
            color: #ff6b35;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.4rem;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .question-description {
            font-size: 1rem;
            color: #666;
            margin-bottom: 25px;
            font-style: italic;
        }

        /* 選項樣式 */
        .options-container {
            display: grid;
            gap: 15px;
        }

        .option {
            background: linear-gradient(135deg, #fff5f3, #ffe8e1);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,107,53,0.1), transparent);
            transition: left 0.6s ease;
        }

        .option:hover::before {
            left: 100%;
        }

        .option:hover {
            border-color: #ff6b35;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 107, 53, 0.2);
        }

        .option.selected {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border-color: #ff6b35;
            transform: scale(1.02);
        }

        .option-label {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .option-icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        .option-description {
            font-size: 0.95rem;
            opacity: 0.8;
        }

        /* 按鈕樣式 */
        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        /* 結果頁面 */
        .result-container {
            display: none;
            text-align: center;
        }

        .result-container.active {
            display: block;
            animation: fadeInUp 1s ease-out;
        }

        .result-header {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
        }

        .result-title {
            font-size: 2.2rem;
            margin-bottom: 15px;
            animation: bounce 2s ease-out;
        }

        .result-score {
            font-size: 3rem;
            font-weight: bold;
            margin: 20px 0;
            animation: pulse 2s infinite;
        }

        .result-type {
            font-size: 1.5rem;
            background: rgba(255,255,255,0.2);
            padding: 15px 30px;
            border-radius: 25px;
            display: inline-block;
            margin: 10px;
        }

        /* 能力雷達圖 */
        .radar-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 15px 35px rgba(255, 107, 53, 0.15);
        }

        .radar-title {
            text-align: center;
            font-size: 1.5rem;
            color: #ff6b35;
            margin-bottom: 20px;
        }

        .radar-chart {
            width: 300px;
            height: 300px;
            margin: 0 auto;
        }

        /* 詳細分析 */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .analysis-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(255, 107, 53, 0.1);
            border-left: 5px solid #ff6b35;
        }

        .analysis-card h3 {
            color: #ff6b35;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .analysis-card p {
            color: #666;
            line-height: 1.6;
        }

        /* 建議卡片 */
        .suggestions {
            background: linear-gradient(135deg, #fff5f3, #ffe8e1);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }

        .suggestions h3 {
            color: #ff6b35;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5rem;
        }

        .suggestion-list {
            list-style: none;
        }

        .suggestion-list li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 107, 53, 0.2);
            position: relative;
            padding-left: 30px;
        }

        .suggestion-list li::before {
            content: '💡';
            position: absolute;
            left: 0;
            top: 10px;
        }

        /* 分享按鈕 */
        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
        }

        .share-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .share-facebook {
            background: #4267B2;
            color: white;
        }

        .share-line {
            background: #00B900;
            color: white;
        }

        .share-twitter {
            background: #1DA1F2;
            color: white;
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* 響應式設計 */
        @media (max-width: 768px) {
            .quiz-title {
                font-size: 2rem;
            }

            .quiz-card {
                padding: 25px;
            }

            .button-container {
                flex-direction: column;
                gap: 15px;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .share-buttons {
                flex-direction: column;
                align-items: center;
            }
        }

        /* 載入動畫 */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f0f0f0;
            border-top: 5px solid #ff6b35;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 測驗標題 -->
        <div class="quiz-header">
            <div class="quiz-title">🎤 聲音表達能力測驗</div>
            <div class="quiz-subtitle">發現你獨特的聲音魅力，找到最適合的表達風格</div>
        </div>

        <!-- 進度條 -->
        <div class="progress-container">
            <div class="progress-info">
                <span class="progress-text">測驗進度</span>
                <span class="progress-text"><span id="current-question">1</span> / <span id="total-questions">15</span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="--progress: 6.67%;"></div>
            </div>
        </div>

        <!-- 問題1: 聲音特質傾向 -->
        <div class="quiz-card active" data-question="1">
            <div class="question-number">問題 1 / 15</div>
            <div class="question-text">當你需要在會議中發言時，你的聲音通常表現為？</div>
            <div class="question-description">選擇最符合你平常表現的選項</div>
            
            <div class="options-container">
                <div class="option" data-value="red" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">🔥</span>
                        堅定有力，直截了當
                    </div>
                    <div class="option-description">語氣堅定，音量適中偏強，表達明確不模糊</div>
                </div>
                <div class="option" data-value="yellow" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">☀️</span>
                        活潑熱情，充滿活力
                    </div>
                    <div class="option-description">語調豐富變化，容易感染他人情緒</div>
                </div>
                <div class="option" data-value="blue" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">🧠</span>
                        冷靜理性，條理清晰
                    </div>
                    <div class="option-description">咬字清楚，邏輯性強，語速穩定</div>
                </div>
                <div class="option" data-value="green" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">🌱</span>
                        溫和親切，體貼他人
                    </div>
                    <div class="option-description">聲音柔和，會考慮聽者的感受</div>
                </div>
            </div>
        </div>

        <!-- 問題2: 情境應對 -->
        <div class="quiz-card" data-question="2">
            <div class="question-number">問題 2 / 15</div>
            <div class="question-text">面對別人的不合理要求時，你會如何回應？</div>
            
            <div class="options-container">
                <div class="option" data-value="red" data-points="4">
                    <div class="option-label">
                        <span class="option-icon">⚡</span>
                        直接拒絕，堅持立場
                    </div>
                    <div class="option-description">明確表達拒絕，不會妥協原則</div>
                </div>
                <div class="option" data-value="blue" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">🤔</span>
                        理性分析，提出替代方案
                    </div>
                    <div class="option-description">冷靜思考後給出合理建議</div>
                </div>
                <div class="option" data-value="green" data-points="2">
                    <div class="option-label">
                        <span class="option-icon">🤝</span>
                        溫和拒絕，避免衝突
                    </div>
                    <div class="option-description">委婉表達不同意見，維護關係和諧</div>
                </div>
                <div class="option" data-value="yellow" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">😊</span>
                        幽默化解，轉換話題
                    </div>
                    <div class="option-description">用輕鬆的方式避開尷尬情況</div>
                </div>
            </div>
        </div>

        <!-- 問題3: 表達偏好 -->
        <div class="quiz-card" data-question="3">
            <div class="question-number">問題 3 / 15</div>
            <div class="question-text">你最喜歡哪種類型的說話內容？</div>
            
            <div class="options-container">
                <div class="option" data-value="blue" data-points="4">
                    <div class="option-label">
                        <span class="option-icon">📊</span>
                        數據分析、專業知識
                    </div>
                    <div class="option-description">喜歡分享有根據的資訊和深度內容</div>
                </div>
                <div class="option" data-value="yellow" data-points="4">
                    <div class="option-label">
                        <span class="option-icon">🎭</span>
                        趣味故事、生活分享
                    </div>
                    <div class="option-description">擅長說故事，讓對話充滿樂趣</div>
                </div>
                <div class="option" data-value="green" data-points="4">
                    <div class="option-label">
                        <span class="option-icon">💝</span>
                        關懷問候、情感支持
                    </div>
                    <div class="option-description">重視情感交流，關心他人感受</div>
                </div>
                <div class="option" data-value="red" data-points="4">
                    <div class="option-label">
                        <span class="option-icon">🎯</span>
                        目標規劃、行動方案
                    </div>
                    <div class="option-description">專注於結果導向的討論</div>
                </div>
            </div>
        </div>

        <!-- 問題4: 聲音控制 -->
        <div class="quiz-card" data-question="4">
            <div class="question-number">問題 4 / 15</div>
            <div class="question-text">在長時間說話後，你通常感到？</div>
            
            <div class="options-container">
                <div class="option" data-value="skill" data-points="1">
                    <div class="option-label">
                        <span class="option-icon">😅</span>
                        聲音疲勞，喉嚨不適
                    </div>
                    <div class="option-description">需要加強呼吸技巧和發聲方法</div>
                </div>
                <div class="option" data-value="skill" data-points="2">
                    <div class="option-label">
                        <span class="option-icon">😐</span>
                        還可以，但有點累
                    </div>
                    <div class="option-description">基本技巧尚可，仍有改善空間</div>
                </div>
                <div class="option" data-value="skill" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">😊</span>
                        感覺良好，聲音穩定
                    </div>
                    <div class="option-description">具備一定的發聲技巧基礎</div>
                </div>
                <div class="option" data-value="skill" data-points="4">
                    <div class="option-label">
                        <span class="option-icon">💪</span>
                        精神飽滿，越說越有力
                    </div>
                    <div class="option-description">擁有良好的聲音控制能力</div>
                </div>
            </div>
        </div>

        <!-- 問題5: 聽眾互動 -->
        <div class="quiz-card" data-question="5">
            <div class="question-number">問題 5 / 15</div>
            <div class="question-text">當發現聽眾注意力不集中時，你會？</div>
            
            <div class="options-container">
                <div class="option" data-value="red" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">📢</span>
                        提高音量，強調重點
                    </div>
                    <div class="option-description">用更強的聲音吸引注意力</div>
                </div>
                <div class="option" data-value="yellow" data-points="4">
                    <div class="option-label">
                        <span class="option-icon">🎪</span>
                        改變語調，增加趣味
                    </div>
                    <div class="option-description">用活潑的方式重新吸引聽眾</div>
                </div>
                <div class="option" data-value="blue" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">🔄</span>
                        調整內容，重新組織
                    </div>
                    <div class="option-description">理性分析並改善表達方式</div>
                </div>
                <div class="option" data-value="green" data-points="3">
                    <div class="option-label">
                        <span class="option-icon">👥</span>
                        詢問感受，關心需求
                    </div>
                    <div class="option-description">體貼地了解聽眾的狀況</div>
                </div>
            </div>
        </div>

        <!-- 載入動畫 -->
        <div class="loading">
            <div class="spinner"></div>
            <p>正在分析你的聲音特質...</p>
        </div>

        <!-- 結果頁面 -->
        <div class="result-container">
            <div class="result-header">
                <div class="result-title">🎉 你的聲音特質分析</div>
                <div class="result-score" id="final-score">85分</div>
                <div class="result-type" id="voice-type">溫暖親和型</div>
            </div>

            <!-- 能力雷達圖 -->
            <div class="radar-container">
                <div class="radar-title">📊 聲音能力雷達圖</div>
                <svg class="radar-chart" viewBox="0 0 300 300">
                    <!-- 背景網格 -->
                    <g class="radar-grid">
                        <circle cx="150" cy="150" r="120" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                        <circle cx="150" cy="150" r="90" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                        <circle cx="150" cy="150" r="60" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                        <circle cx="150" cy="150" r="30" fill="none" stroke="#f0f0f0" stroke-width="1"/>
                        
                        <!-- 軸線 -->
                        <line x1="150" y1="30" x2="150" y2="270" stroke="#f0f0f0" stroke-width="1"/>
                        <line x1="30" y1="150" x2="270" y2="150" stroke="#f0f0f0" stroke-width="1"/>
                        <line x1="63.4" y1="63.4" x2="236.6" y2="236.6" stroke="#f0f0f0" stroke-width="1"/>
                        <line x1="236.6" y1="63.4" x2="63.4" y2="236.6" stroke="#f0f0f0" stroke-width="1"/>
                    </g>
                    
                    <!-- 數據多邊形 -->
                    <polygon id="radar-polygon" fill="rgba(255, 107, 53, 0.3)" stroke="#ff6b35" stroke-width="2"/>
                    
                    <!-- 標籤 -->
                    <text x="150" y="25" text-anchor="middle" font-size="12" font-weight="bold">表達力</text>
                    <text x="260" y="95" text-anchor="middle" font-size="12" font-weight="bold">感染力</text>
                    <text x="260" y="210" text-anchor="middle" font-size="12" font-weight="bold">親和力</text>
                    <text x="150" y="285" text-anchor="middle" font-size="12" font-weight="bold">穩定性</text>
                    <text x="40" y="210" text-anchor="middle" font-size="12" font-weight="bold">專業度</text>
                    <text x="40" y="95" text-anchor="middle" font-size="12" font-weight="bold">邏輯性</text>
                </svg>
            </div>

            <!-- 詳細分析 -->
            <div class="analysis-grid" id="analysis-results">
                <!-- 動態生成分析內容 -->
            </div>

            <!-- 個人化建議 -->
            <div class="suggestions">
                <h3>🎯 專屬提升建議</h3>
                <ul class="suggestion-list" id="suggestions-list">
                    <!-- 動態生成建議內容 -->
                </ul>
            </div>

            <!-- 分享按鈕 -->
            <div class="share-buttons">
                <button class="share-btn share-facebook" onclick="shareResult('facebook')">分享到 Facebook</button>
                <button class="share-btn share-line" onclick="shareResult('line')">分享到 LINE</button>
                <button class="share-btn share-twitter" onclick="shareResult('twitter')">分享到 Twitter</button>
            </div>

            <div class="button-container">
                <button class="btn btn-primary" onclick="restartQuiz()">重新測驗</button>
                <button class="btn btn-secondary" onclick="viewDetailedReport()">詳細報告</button>
            </div>
        </div>

        <!-- 導航按鈕 -->
        <div class="button-container" id="navigation-buttons">
            <button class="btn btn-secondary" id="prev-btn" onclick="previousQuestion()" style="display: none;">上一題</button>
            <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" disabled>下一題</button>
        </div>
    </div>

    <script>
        // 測驗狀態管理
        let currentQuestion = 1;
        let totalQuestions = 15;
        let answers = {};
        let scores = {
            red: 0,
            yellow: 0,
            blue: 0,
            green: 0,
            skill: 0
        };

        // 問題數據（簡化版，實際應用中可從外部加載）
        const questions = [
            // 前5題已在HTML中定義
            {
                id: 6,
                text: "你認為自己的聲音最大的優勢是？",
                options: [
                    { value: "blue", points: 4, icon: "🎯", label: "清晰準確", desc: "咬字清楚，表達精準" },
                    { value: "yellow", points: 4, icon: "✨", label: "生動有趣", desc: "能夠吸引他人注意" },
                    { value: "green", points: 4, icon: "💕", label: "溫暖療癒", desc: "讓人感到舒適安心" },
                    { value: "red", points: 4, icon: "💪", label: "有說服力", desc: "能夠影響他人決定" }
                ]
            },
            // 可以繼續添加更多問題...
        ];

        // 初始化測驗
        function initQuiz() {
            updateProgress();
            setupEventListeners();
        }

        // 設置事件監聽器
        function setupEventListeners() {
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function() {
                    selectOption(this);
                });
            });
        }

        // 選擇選項
        function selectOption(selectedOption) {
            // 移除當前問題所有選項的選中狀態
            const currentCard = document.querySelector('.quiz-card.active');
            currentCard.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });

            // 選中當前選項
            selectedOption.classList.add('selected');
            
            // 記錄答案
            const questionNum = parseInt(currentCard.dataset.question);
            const value = selectedOption.dataset.value;
            const points = parseInt(selectedOption.dataset.points);
            
            answers[questionNum] = { value, points };
            
            // 啟用下一題按鈕
            document.getElementById('next-btn').disabled = false;
        }

        // 下一題
        function nextQuestion() {
            if (currentQuestion < totalQuestions) {
                // 隱藏當前問題
                document.querySelector('.quiz-card.active').classList.remove('active');
                currentQuestion++;
                
                // 如果是最後幾題，需要動態生成
                if (currentQuestion > 5) {
                    generateQuestion(currentQuestion);
                }
                
                // 顯示下一題
                const nextCard = document.querySelector(`[data-question="${currentQuestion}"]`);
                if (nextCard) {
                    nextCard.classList.add('active');
                }
                
                updateProgress();
                updateNavigationButtons();
            } else {
                // 完成測驗
                finishQuiz();
            }
        }

        // 上一題
        function previousQuestion() {
            if (currentQuestion > 1) {
                document.querySelector('.quiz-card.active').classList.remove('active');
                currentQuestion--;
                
                const prevCard = document.querySelector(`[data-question="${currentQuestion}"]`);
                if (prevCard) {
                    prevCard.classList.add('active');
                }
                
                updateProgress();
                updateNavigationButtons();
            }
        }

        // 更新進度
        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            document.getElementById('current-question').textContent = currentQuestion;
            document.getElementById('progress-fill').style.setProperty('--progress', progress + '%');
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        // 更新導航按鈕
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.style.display = currentQuestion > 1 ? 'block' : 'none';
            nextBtn.textContent = currentQuestion === totalQuestions ? '完成測驗' : '下一題';
            
            // 檢查當前題目是否已回答
            const hasAnswer = answers[currentQuestion];
            nextBtn.disabled = !hasAnswer;
        }

        // 動態生成問題
        function generateQuestion(questionNum) {
            if (questionNum <= 5) return; // 前5題已在HTML中
            
            const questionData = questions[questionNum - 6];
            if (!questionData) {
                // 生成隨機問題
                generateRandomQuestion(questionNum);
                return;
            }
            
            const card = document.createElement('div');
            card.className = 'quiz-card';
            card.setAttribute('data-question', questionNum);
            
            card.innerHTML = `
                <div class="question-number">問題 ${questionNum} / ${totalQuestions}</div>
                <div class="question-text">${questionData.text}</div>
                <div class="options-container">
                    ${questionData.options.map(opt => `
                        <div class="option" data-value="${opt.value}" data-points="${opt.points}">
                            <div class="option-label">
                                <span class="option-icon">${opt.icon}</span>
                                ${opt.label}
                            </div>
                            <div class="option-description">${opt.desc}</div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.querySelector('.container').insertBefore(card, document.getElementById('navigation-buttons'));
            
            // 添加事件監聽器
            card.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function() {
                    selectOption(this);
                });
            });
        }

        // 生成隨機問題（用於演示）
        function generateRandomQuestion(questionNum) {
            const randomQuestions = [
                {
                    text: "在團隊討論中，你傾向於扮演什麼角色？",
                    options: [
                        { value: "red", points: 4, icon: "👑", label: "領導者", desc: "主導討論方向" },
                        { value: "blue", points: 3, icon: "🔍", label: "分析者", desc: "提供客觀分析" },
                        { value: "yellow", points: 3, icon: "💡", label: "創意者", desc: "提出新想法" },
                        { value: "green", points: 3, icon: "🤝", label: "協調者", desc: "維護團隊和諧" }
                    ]
                },
                {
                    text: "面對壓力情況時，你的聲音會？",
                    options: [
                        { value: "skill", points: 1, icon: "😰", label: "變得緊張不穩", desc: "需要加強抗壓訓練" },
                        { value: "skill", points: 2, icon: "😐", label: "稍微受影響", desc: "基本控制能力尚可" },
                        { value: "skill", points: 3, icon: "😌", label: "保持相對穩定", desc: "具備良好的情緒管理" },
                        { value: "skill", points: 4, icon: "💪", label: "更加堅定有力", desc: "優秀的壓力轉換能力" }
                    ]
                }
            ];
            
            const questionData = randomQuestions[(questionNum - 6) % randomQuestions.length];
            
            const card = document.createElement('div');
            card.className = 'quiz-card';
            card.setAttribute('data-question', questionNum);
            
            card.innerHTML = `
                <div class="question-number">問題 ${questionNum} / ${totalQuestions}</div>
                <div class="question-text">${questionData.text}</div>
                <div class="options-container">
                    ${questionData.options.map(opt => `
                        <div class="option" data-value="${opt.value}" data-points="${opt.points}">
                            <div class="option-label">
                                <span class="option-icon">${opt.icon}</span>
                                ${opt.label}
                            </div>
                            <div class="option-description">${opt.desc}</div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.querySelector('.container').insertBefore(card, document.getElementById('navigation-buttons'));
            
            // 添加事件監聽器
            card.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function() {
                    selectOption(this);
                });
            });
        }

        // 完成測驗
        function finishQuiz() {
            // 顯示載入動畫
            document.querySelector('.quiz-card.active').style.display = 'none';
            document.getElementById('navigation-buttons').style.display = 'none';
            document.querySelector('.loading').classList.add('active');
            
            // 計算分數
            setTimeout(() => {
                calculateResults();
                showResults();
            }, 2000);
        }

        // 計算結果
        function calculateResults() {
            // 統計各類型分數
            Object.values(answers).forEach(answer => {
                if (scores.hasOwnProperty(answer.value)) {
                    scores[answer.value] += answer.points;
                }
            });
            
            // 找出主導類型
            const maxScore = Math.max(scores.red, scores.yellow, scores.blue, scores.green);
            let dominantType = '';
            
            if (scores.red === maxScore) dominantType = 'red';
            else if (scores.yellow === maxScore) dominantType = 'yellow';
            else if (scores.blue === maxScore) dominantType = 'blue';
            else dominantType = 'green';
            
            // 計算總分
            const totalScore = Math.round((scores.red + scores.yellow + scores.blue + scores.green + scores.skill) / Object.keys(answers).length * 100 / 4);
            
            return { dominantType, totalScore, scores };
        }

        // 顯示結果
        function showResults() {
            const results = calculateResults();
            
            // 隱藏載入動畫
            document.querySelector('.loading').classList.remove('active');
            
            // 顯示結果頁面
            document.querySelector('.result-container').classList.add('active');
            
            // 更新結果顯示
            document.getElementById('final-score').textContent = results.totalScore + '分';
            
            const typeNames = {
                red: '領導決斷型',
                yellow: '活力感染型',
                blue: '專業理性型',
                green: '溫暖親和型'
            };
            
            document.getElementById('voice-type').textContent = typeNames[results.dominantType];
            
            // 繪製雷達圖
            drawRadarChart(results.scores);
            
            // 生成分析內容
            generateAnalysis(results);
            
            // 生成建議
            generateSuggestions(results);
        }

        // 繪製雷達圖
        function drawRadarChart(scores) {
            const radar = document.getElementById('radar-polygon');
            const center = 150;
            const maxRadius = 120;
            
            // 計算各項能力值（0-100轉換為半徑）
            const values = [
                scores.red / 20 * maxRadius,      // 表達力
                scores.yellow / 20 * maxRadius,   // 感染力
                scores.green / 20 * maxRadius,    // 親和力
                scores.skill / 4 * maxRadius,     // 穩定性
                scores.blue / 20 * maxRadius,     // 專業度
                scores.blue / 20 * maxRadius      // 邏輯性
            ];
            
            // 計算六邊形頂點坐標
            const points = values.map((value, index) => {
                const angle = (index * 60 - 90) * Math.PI / 180; // 從12點方向開始
                const x = center + value * Math.cos(angle);
                const y = center + value * Math.sin(angle);
                return `${x},${y}`;
            }).join(' ');
            
            radar.setAttribute('points', points);
        }

        // 生成分析內容
        function generateAnalysis(results) {
            const analysisContainer = document.getElementById('analysis-results');
            
            const analysisData = {
                red: {
                    title: '🔥 領導決斷力',
                    content: '你具備天生的領導氣質，聲音堅定有力，能夠在關鍵時刻做出明確決策。在團隊中往往能夠承擔責任，帶領他人前進。'
                },
                yellow: {
                    title: '☀️ 表現感染力',
                    content: '你的聲音充滿活力和熱情，能夠輕易感染周圍的人。在需要激勵他人或營造氣氛時，你的表現特別出色。'
                },
                blue: {
                    title: '🧠 專業理性度',
                    content: '你的表達邏輯清晰，條理分明，給人專業可信賴的感覺。在需要傳達複雜資訊或進行分析時特別有效。'
                },
                green: {
                    title: '🌱 溫暖親和力',
                    content: '你的聲音溫和親切，讓人感到舒適和安心。在需要安慰他人或建立信任關係時，你的優勢非常明顯。'
                }
            };
            
            // 根據得分生成分析卡片
            Object.keys(results.scores).forEach(type => {
                if (type === 'skill') return;
                
                const score = results.scores[type];
                if (score > 5) { // 只顯示得分較高的特質
                    const analysis = analysisData[type];
                    const card = document.createElement('div');
                    card.className = 'analysis-card';
                    card.innerHTML = `
                        <h3>${analysis.title}</h3>
                        <div style="margin-bottom: 10px;">
                            <div style="background: #f0f0f0; height: 8px; border-radius: 4px; overflow: hidden;">
                                <div style="width: ${score/20*100}%; height: 100%; background: linear-gradient(90deg, #ff6b35, #f7931e); transition: width 1s ease;"></div>
                            </div>
                            <small style="color: #666;">${score}/20 分</small>
                        </div>
                        <p>${analysis.content}</p>
                    `;
                    analysisContainer.appendChild(card);
                }
            });
        }

        // 生成建議
        function generateSuggestions(results) {
            const suggestionsList = document.getElementById('suggestions-list');
            const suggestions = [];
            
            // 根據不同類型給出建議
            if (results.dominantType === 'red') {
                suggestions.push(
                    '適度降低聲音強度，避免給人壓迫感',
                    '多練習傾聽技巧，給他人表達機會',
                    '在批評時注意語氣，多用建設性語言'
                );
            } else if (results.dominantType === 'yellow') {
                suggestions.push(
                    '注意控制語速，確保重要資訊被清楚傳達',
                    '在正式場合適度收斂表現欲',
                    '多練習邏輯性表達，提升說服力'
                );
            } else if (results.dominantType === 'blue') {
                suggestions.push(
                    '適當增加情緒表達，讓聲音更有溫度',
                    '多練習生動的表達方式，提升感染力',
                    '在團隊溝通中多關注他人感受'
                );
            } else if (results.dominantType === 'green') {
                suggestions.push(
                    '適當提升聲音的堅定度，增強說服力',
                    '多練習在衝突中表達不同意見',
                    '培養更多的表現自信，不要過度謙遜'
                );
            }
            
            // 根據技能分數給出通用建議
            if (results.scores.skill < 8) {
                suggestions.push(
                    '多練習腹式呼吸，提升聲音穩定性',
                    '注意發聲位置，避免用嗓過度',
                    '定期做聲音訓練，增強聲帶健康'
                );
            }
            
            suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                suggestionsList.appendChild(li);
            });
        }

        // 分享結果
        function shareResult(platform) {
            const results = calculateResults();
            const typeNames = {
                red: '領導決斷型',
                yellow: '活力感染型',
                blue: '專業理性型',
                green: '溫暖親和型'
            };
            
            const shareText = `我的聲音表達能力測驗結果：${results.totalScore}分，類型是「${typeNames[results.dominantType]}」！快來測試你的聲音魅力吧！`;
            const shareUrl = window.location.href;
            
            switch(platform) {
                case 'facebook':
                    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(shareText)}`);
                    break;
                case 'line':
                    window.open(`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(shareText)}`);
                    break;
                case 'twitter':
                    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`);
                    break;
            }
        }

        // 重新測驗
        function restartQuiz() {
            currentQuestion = 1;
            answers = {};
            scores = { red: 0, yellow: 0, blue: 0, green: 0, skill: 0 };
            
            // 重置UI
            document.querySelector('.result-container').classList.remove('active');
            document.querySelector('[data-question="1"]').classList.add('active');
            document.getElementById('navigation-buttons').style.display = 'flex';
            
            // 清除所有選擇
            document.querySelectorAll('.option.selected').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // 移除動態生成的問題
            document.querySelectorAll('[data-question]').forEach(card => {
                if (parseInt(card.dataset.question) > 5) {
                    card.remove();
                }
            });
            
            updateProgress();
            updateNavigationButtons();
        }

        // 查看詳細報告
        function viewDetailedReport() {
            alert('詳細報告功能開發中，敬請期待！');
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initQuiz();
            
            // 生成剩餘問題（演示用）
            for (let i = 6; i <= totalQuestions; i++) {
                generateRandomQuestion(i);
            }
        });
    </script>
</body>
</html>